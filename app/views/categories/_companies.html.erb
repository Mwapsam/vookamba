<section>
	<div class="container py-6">
		<div class="row">
			<div class="col-md-12 text-center">
				<div class="lc-block text-center text-md-start mb-5">
					<div editable="rich" class="d-flex justify-content-between">
						<h5 class="p-text text-center">Top Rated Companies in <%= Time.now.strftime("%B") %></h5>
                        <%= link_to "View all", companies_path, class: "btn-view p-2 rounded text-white", data: {turbo: false} %>
					</div>
				</div><!-- /lc-block -->
			</div>
		</div>

		<div class="row pt-4">
            <% @companies.each do |company| %>
                    <div class="col-md-6 mb-6 mb-md-5 pt-4">
                        <div class="lc-block p-4 card shadow position-relative">
                            <div class="card-body">
                                 <%= link_to company_path(company.id), data: {turbo: false} do %>
                                    <div class="lc-block position-absolute top-0 mt-n4 bg-primary p-3 rounded-3 shadow">
                                        <%= image_tag company.image, width: "30em", height: "30em"%>
                                    </div>

                                    <div class="lc-block pt-5 ">
                                        <div editable="rich">

                                            <h2 class="fw-bold h3"><%= company.name %></h2>
                                            <p class="rfs-7"><%= company.description %></p>
                                        </div>
                                        <div class="d-flex justify-content-around">
                                            <div>
                                                <div class="average-review-rating" data-score=<%= company.reviews.average(:rating).round(2) %>></div>
                                            </div>
                                            <p class="fw-bolder"><%= company.reviews.average(:rating).round(2)%> rating</p>
                                        </div>
                                    </div>
                                <% end %>
                            </div>
                        </div><!-- /lc-block -->
                    </div>
            <% end %>
		</div>
	</div>
</section>

<script>
  $('.average-review-rating').raty({
    readOnly: true,
        score: function() {
            return $(this).attr('data-score');
        },
        path: '/assets/'
  })
</script>